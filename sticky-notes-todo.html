<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataNotes - AI Task Manager</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@300;400;500;600&display=swap');

        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --text-primary: #f0f6fc;
            --text-secondary: #8b949e;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-purple: #a5a5ff;
            --accent-orange: #ffa657;
            --accent-red: #f85149;
            --accent-pink: #f778ba;
            --accent-yellow: #f9e71e;
            --border: #30363d;
            --shadow: rgba(0, 0, 0, 0.3);
            --pending-color: var(--accent-orange);
            --completed-color: var(--accent-green);
            --priority-color: var(--accent-red);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated AI/Data Science Background */
        .ai-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
            pointer-events: none;
        }

        .neural-network {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #58a6ff, transparent),
                radial-gradient(2px 2px at 40px 70px, #3fb950, transparent),
                radial-gradient(1px 1px at 90px 40px, #a5a5ff, transparent),
                radial-gradient(1px 1px at 130px 80px, #ffa657, transparent),
                radial-gradient(2px 2px at 160px 30px, #f778ba, transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: neuralFlow 20s linear infinite;
        }

        @keyframes neuralFlow {
            0% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(-50px) translateY(-25px); }
            50% { transform: translateX(-100px) translateY(-50px); }
            75% { transform: translateX(-50px) translateY(-75px); }
            100% { transform: translateX(0) translateY(-100px); }
        }

        .data-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(45deg, transparent 40%, rgba(88, 166, 255, 0.05) 50%, transparent 60%),
                linear-gradient(-45deg, transparent 40%, rgba(63, 185, 80, 0.05) 50%, transparent 60%);
            background-size: 100px 100px, 150px 150px;
            animation: dataFlow 15s linear infinite;
        }

        @keyframes dataFlow {
            0% { background-position: 0 0, 0 0; }
            100% { background-position: 100px 100px, -150px 150px; }
        }

        .matrix-rain {
            position: absolute;
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: var(--accent-green);
            opacity: 0.3;
            animation: matrixFall 10s linear infinite;
        }

        @keyframes matrixFall {
            0% { transform: translateY(-100vh); opacity: 1; }
            100% { transform: translateY(100vh); opacity: 0; }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.8rem;
            font-weight: 600;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .header .subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace;
        }

        .controls-section {
            max-width: 800px;
            margin: 0 auto 40px;
        }

        .add-note-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px var(--shadow);
            backdrop-filter: blur(20px);
        }

        .add-note-form {
            display: flex;
            gap: 12px;
            align-items: stretch;
        }

        .add-note-input {
            flex: 1;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 14px 16px;
            font-size: 14px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            transition: all 0.2s ease;
            outline: none;
        }

        .add-note-input:focus {
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.1);
        }

        .add-note-btn {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            color: white;
            border: none;
            border-radius: 8px;
            padding: 14px 24px;
            font-size: 14px;
            font-weight: 500;
            font-family: 'JetBrains Mono', monospace;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .add-note-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.3);
        }

        .export-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }

        .export-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            border-radius: 6px;
            padding: 8px 16px;
            font-size: 12px;
            font-family: 'JetBrains Mono', monospace;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .export-btn:hover {
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
        }

        .stat-item {
            color: var(--text-secondary);
        }

        .stat-value {
            color: var(--accent-green);
            font-weight: 500;
        }

        .categories-nav {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .category-tab {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 10px 20px;
            border-radius: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .category-tab.active {
            border-color: var(--accent-blue);
            color: var(--accent-blue);
            background: rgba(88, 166, 255, 0.1);
        }

        .category-tab .count {
            background: var(--accent-blue);
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 10px;
            margin-left: 8px;
        }

        .category-tab.pending .count { background: var(--pending-color); }
        .category-tab.completed .count { background: var(--completed-color); }
        .category-tab.priority .count { background: var(--priority-color); }

        .notes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .note-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            min-height: 160px;
            display: flex;
            flex-direction: column;
            animation: noteSlideIn 0.4s ease-out;
        }

        .note-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            border-radius: 12px 12px 0 0;
            transition: all 0.3s ease;
        }

        .note-card.pending::before { background: var(--pending-color); }
        .note-card.completed::before { background: var(--completed-color); }
        .note-card.priority::before { background: var(--priority-color); }

        .note-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px var(--shadow);
        }

        .note-card.pending:hover { border-color: var(--pending-color); }
        .note-card.completed:hover { border-color: var(--completed-color); }
        .note-card.priority:hover { border-color: var(--priority-color); }

        .note-card.completed {
            opacity: 0.7;
        }

        .note-card.completed .note-content {
            text-decoration: line-through;
        }

        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .note-status {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-badge {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 500;
        }

        .status-badge.pending { background: rgba(255, 166, 87, 0.2); color: var(--pending-color); }
        .status-badge.completed { background: rgba(63, 185, 80, 0.2); color: var(--completed-color); }
        .status-badge.priority { background: rgba(248, 81, 73, 0.2); color: var(--priority-color); }

        .category-controls {
            display: flex;
            gap: 5px;
            margin-top: 16px;
        }

        .category-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .category-btn:hover {
            background: var(--bg-primary);
        }

        .category-btn.pending:hover { border-color: var(--pending-color); color: var(--pending-color); }
        .category-btn.completed:hover { border-color: var(--completed-color); color: var(--completed-color); }
        .category-btn.priority:hover { border-color: var(--priority-color); color: var(--priority-color); }

        /* Celebration Modal */
        .celebration-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .celebration-modal.show {
            display: flex;
            animation: modalAppear 0.5s ease-out;
        }

        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .celebration-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 500px;
            position: relative;
        }

        .celebration-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .surprise-box {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--accent-yellow), var(--accent-orange));
            border-radius: 10px;
            margin: 20px auto;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            transition: all 0.3s ease;
            animation: bounce 2s infinite;
        }

        .surprise-box:hover {
            transform: scale(1.1);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .quote-text {
            font-size: 1.2rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin: 20px 0;
            font-style: italic;
            display: none;
        }

        .quote-author {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 10px;
            display: none;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        @keyframes noteSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes noteSlideOut {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
        }

        .empty-state {
            text-align: center;
            margin-top: 80px;
            color: var(--text-secondary);
            grid-column: 1 / -1;
        }

        .empty-state .icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        @media (max-width: 768px) {
            .categories-nav {
                gap: 10px;
            }
            
            .stats-bar {
                gap: 15px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <!-- Animated AI Background -->
    <div class="ai-background">
        <div class="neural-network"></div>
        <div class="data-particles"></div>
    </div>

    <div class="header">
        <h1>DataNotes AI</h1>
        <p class="subtitle">// Intelligent task management for data scientists</p>
    </div>

    <div class="controls-section">
        <div class="add-note-container">
            <div class="add-note-form">
                <input 
                    type="text" 
                    class="add-note-input" 
                    placeholder="# Add a new task or insight..."
                    maxlength="500"
                >
                <button class="add-note-btn">+ CREATE</button>
            </div>
            <div class="export-controls">
                <button class="export-btn" onclick="app.exportToPDF()">📄 Export PDF</button>
                <button class="export-btn" onclick="app.exportToWord()">📝 Export DOCX</button>
                <button class="export-btn" onclick="app.exportToJSON()">💾 Backup JSON</button>
            </div>
        </div>
    </div>

    <div class="stats-bar">
        <div class="stat-item">
            Total: <span class="stat-value" id="totalCount">0</span>
        </div>
        <div class="stat-item">
            Pending: <span class="stat-value" id="pendingCount">0</span>
        </div>
        <div class="stat-item">
            Completed: <span class="stat-value" id="completedCount">0</span>
        </div>
        <div class="stat-item">
            Priority: <span class="stat-value" id="priorityCount">0</span>
        </div>
        <div class="stat-item">
            Session: <span class="stat-value" id="sessionTime">00:00</span>
        </div>
    </div>

    <div class="categories-nav">
        <button class="category-tab active" data-category="all">
            All Tasks <span class="count" id="allCount">0</span>
        </button>
        <button class="category-tab pending" data-category="pending">
            Pending <span class="count" id="pendingTabCount">0</span>
        </button>
        <button class="category-tab completed" data-category="completed">
            Completed <span class="count" id="completedTabCount">0</span>
        </button>
        <button class="category-tab priority" data-category="priority">
            Priority <span class="count" id="priorityTabCount">0</span>
        </button>
    </div>

    <div class="notes-grid" id="notesContainer">
        <div class="empty-state">
            <div class="icon">🤖</div>
            <h3>Initialize AI workspace</h3>
            <p>// Start your data science journey</p>
        </div>
    </div>

    <!-- Celebration Modal -->
    <div class="celebration-modal" id="celebrationModal">
        <div class="celebration-content">
            <button class="close-btn" onclick="app.closeCelebration()">&times;</button>
            <div class="celebration-title">🎉 All Tasks Completed!</div>
            <p>Outstanding work! You've conquered all your tasks.</p>
            <div class="surprise-box" onclick="app.showQuote()">🎁</div>
            <div class="quote-text" id="quoteText"></div>
            <div class="quote-author" id="quoteAuthor"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        class DataNotesAI {
            constructor() {
                this.notes = [];
                this.noteIdCounter = 1;
                this.sessionStartTime = Date.now();
                this.currentFilter = 'all';
                this.celebrationShown = false;
                this.quotes = [
                    { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
                    { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
                    { text: "Don't be afraid to give up the good to go for the great.", author: "John D. Rockefeller" },
                    { text: "Innovation distinguishes between a leader and a follower.", author: "Steve Jobs" },
                    { text: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt" },
                    { text: "Success is walking from failure to failure with no loss of enthusiasm.", author: "Winston Churchill" },
                    { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
                    { text: "Data is the new oil, but like oil, it's valuable only when refined.", author: "Clive Humby" },
                    { text: "In God we trust. All others must bring data.", author: "W. Edwards Deming" },
                    { text: "Without big data analytics, companies are blind and deaf, wandering out onto the web like deer on a freeway.", author: "Geoffrey Moore" }
                ];
                this.init();
                this.startSessionTimer();
                this.createMatrixRain();
            }

            init() {
                this.bindEvents();
                this.updateDisplay();
            }

            createMatrixRain() {
                const matrixChars = '01数据AIMLπΣ∑∞∂∇⊕⊗≡≈≠∈∉∪∩⊆⊇∧∨¬→←↑↓∀∃∄∅';
                for (let i = 0; i < 15; i++) {
                    setTimeout(() => {
                        const drop = document.createElement('div');
                        drop.className = 'matrix-rain';
                        drop.style.left = Math.random() * 100 + '%';
                        drop.style.animationDelay = Math.random() * 10 + 's';
                        drop.textContent = matrixChars[Math.floor(Math.random() * matrixChars.length)];
                        document.querySelector('.ai-background').appendChild(drop);
                        
                        setTimeout(() => drop.remove(), 10000);
                    }, i * 500);
                }
                
                setInterval(() => {
                    if (document.querySelectorAll('.matrix-rain').length < 10) {
                        const drop = document.createElement('div');
                        drop.className = 'matrix-rain';
                        drop.style.left = Math.random() * 100 + '%';
                        drop.textContent = matrixChars[Math.floor(Math.random() * matrixChars.length)];
                        document.querySelector('.ai-background').appendChild(drop);
                        
                        setTimeout(() => drop.remove(), 10000);
                    }
                }, 2000);
            }

            bindEvents() {
                const addBtn = document.querySelector('.add-note-btn');
                const addInput = document.querySelector('.add-note-input');
                
                addBtn.addEventListener('click', () => this.addNote());
                addInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.addNote();
                });

                // Category filter events
                document.querySelectorAll('.category-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        this.currentFilter = tab.dataset.category;
                        this.updateDisplay();
                    });
                });
            }

            addNote() {
                const input = document.querySelector('.add-note-input');
                const content = input.value.trim();
                
                if (!content) return;

                const note = {
                    id: this.noteIdCounter++,
                    content: content,
                    category: 'pending',
                    createdAt: new Date(),
                    lastModified: new Date()
                };

                this.notes.unshift(note);
                input.value = '';
                this.updateDisplay();
                
                setTimeout(() => {
                    const noteElement = document.querySelector(`[data-id="${note.id}"]`);
                    if (noteElement) {
                        noteElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }, 100);
            }

            changeCategory(id, newCategory) {
                const note = this.notes.find(n => n.id === id);
                if (note) {
                    note.category = newCategory;
                    note.lastModified = new Date();
                    this.updateDisplay();
                    this.checkCompletion();
                }
            }

            checkCompletion() {
                const totalNotes = this.notes.length;
                const completedNotes = this.notes.filter(n => n.category === 'completed').length;
                
                if (totalNotes > 0 && completedNotes === totalNotes && !this.celebrationShown) {
                    this.celebrationShown = true;
                    document.getElementById('celebrationModal').classList.add('show');
                }
                
                if (completedNotes < totalNotes) {
                    this.celebrationShown = false;
                }
            }

            showQuote() {
                const quote = this.quotes[Math.floor(Math.random() * this.quotes.length)];
                document.getElementById('quoteText').textContent = quote.text;
                document.getElementById('quoteAuthor').textContent = `— ${quote.author}`;
                document.getElementById('quoteText').style.display = 'block';
                document.getElementById('quoteAuthor').style.display = 'block';
                document.querySelector('.surprise-box').style.display = 'none';
            }

            closeCelebration() {
                document.getElementById('celebrationModal').classList.remove('show');
                document.getElementById('quoteText').style.display = 'none';
                document.getElementById('quoteAuthor').style.display = 'none';
                document.querySelector('.surprise-box').style.display = 'flex';
            }

            editNote(id, newContent) {
                const note = this.notes.find(n => n.id === id);
                if (note) {
                    note.content = newContent.trim();
                    note.lastModified = new Date();
                    if (!note.content) {
                        this.deleteNote(id);
                    } else {
                        this.updateDisplay();
                    }
                }
            }

            deleteNote(id) {
                const noteElement = document.querySelector(`[data-id="${id}"]`);
                if (noteElement) {
                    noteElement.style.animation = 'noteSlideOut 0.3s ease-in forwards';
                    setTimeout(() => {
                        this.notes = this.notes.filter(n => n.id !== id);
                        this.updateDisplay();
                    }, 300);
                }
            }

            formatTimestamp(date) {
                const now = new Date();
                const diff = now - date;
                const minutes = Math.floor(diff / 60000);
                const hours = Math.floor(minutes / 60);
                const days = Math.floor(hours / 24);

                if (days > 0) return `${days}d ago`;
                if (hours > 0) return `${hours}h ago`;
                if (minutes > 0) return `${minutes}m ago`;
                return 'just now';
            }

            startSessionTimer() {
                setInterval(() => {
                    const elapsed = Date.now() - this.sessionStartTime;
                    const minutes = Math.floor(elapsed / 60000);
                    const seconds = Math.floor((elapsed % 60000) / 1000);
                    document.getElementById('sessionTime').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }

            getFilteredNotes() {
                if (this.currentFilter === 'all') return this.notes;
                return this.notes.filter(note => note.category === this.currentFilter);
            }

            updateStats() {
                const total = this.notes.length;
                const pending = this.notes.filter(n => n.category === 'pending').length;
                const completed = this.notes.filter(n => n.category === 'completed').length;
                const priority = this.notes.filter(n => n.category === 'priority').length;

                document.getElementById('totalCount').textContent = total;
                document.getElementById('pendingCount').textContent = pending;
                document.getElementById('completedCount').textContent = completed;
                document.getElementById('priorityCount').textContent = priority;

                document.getElementById('allCount').textContent = total;
                document.getElementById('pendingTabCount').textContent = pending;
                document.getElementById('completedTabCount').textContent = completed;
                document.getElementById('priorityTabCount').textContent = priority;
            }

            updateDisplay() {
                const container = document.getElementById('notesContainer');
                const filteredNotes = this.getFilteredNotes();
                
                this.updateStats();

                if (filteredNotes.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="icon">${this.currentFilter === 'all' ? '🤖' : this.currentFilter === 'pending' ? '⏳' : this.currentFilter === 'completed' ? '✅' : '🔥'}</div>
                            <h3>${this.currentFilter === 'all' ? 'Initialize AI workspace' : this.currentFilter === 'pending' ? 'No pending tasks' : this.currentFilter === 'completed' ? 'No completed tasks' : 'No priority tasks'}</h3>
                            <p>// ${this.currentFilter === 'all' ? 'Start your data science journey' : this.currentFilter === 'pending' ? 'All tasks are completed!' : this.currentFilter === 'completed' ? 'Complete some tasks first' : 'Mark tasks as priority'}</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = filteredNotes.map(note => `
                    <div class="note-card ${note.category}" data-id="${note.id}">
                        <div class="note-header">
                            <div class="note-status">
                                <span class="status-badge ${note.category}">${note.category}</span>
                                <span>${this.formatTimestamp(note.lastModified)}</span>
                            </div>
                            <button onclick="app.deleteNote(${note.id})" style="background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 16px;">×</button>
                        </div>
                        <div class="note-content" contenteditable="true" onblur="app.editNote(${note.id}, this.textContent)" style="flex: 1; outline: none; margin-bottom: 12px; line-height: 1.5;">${note.content}</div>
                        <div class="category-controls">
                            <button class="category-btn pending" onclick="app.changeCategory(${note.id}, 'pending')" ${note.category === 'pending' ? 'style="border-color: var(--pending-color); color: var(--pending-color);"' : ''}>⏳ Pending</button>
                            <button class="category-btn completed" onclick="app.changeCategory(${note.id}, 'completed')" ${note.category === 'completed' ? 'style="border-color: var(--completed-color); color: var(--completed-color);"' : ''}>✅ Done</button>
                            <button class="category-btn priority" onclick="app.changeCategory(${note.id}, 'priority')" ${note.category === 'priority' ? 'style="border-color: var(--priority-color); color: var(--priority-color);"' : ''}>🔥 Priority</button>
                        </div>
                    </div>
                `).join('');
            }

            // Export functions
            exportToPDF() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                doc.setFontSize(20);
                doc.text('DataNotes AI - Task Report', 20, 20);
                
                doc.setFontSize(12);
                let y = 40;
                
                this.notes.forEach((note, index) => {
                    if (y > 250) {
                        doc.addPage();
                        y = 20;
                    }
                    
                    doc.setFontSize(14);
                    doc.text(`${index + 1}. ${note.content}`, 20, y);
                    y += 10;
                    
                    doc.setFontSize(10);
                    doc.text(`Status: ${note.category} | Created: ${note.createdAt.toLocaleDateString()}`, 20, y);
                    y += 15;
                });
                
                doc.save('datanotes-report.pdf');
            }

            exportToWord() {
                let content = '<html><head><title>DataNotes AI Report</title></head><body>';
                content += '<h1>DataNotes AI - Task Report</h1>';
                content += '<p>Generated on: ' + new Date().toLocaleString() + '</p>';
                
                this.notes.forEach((note, index) => {
                    content += `<h3>${index + 1}. ${note.content}</h3>`;
                    content += `<p><strong>Status:</strong> ${note.category} | <strong>Created:</strong> ${note.createdAt.toLocaleDateString()}</p>`;
                });
                
                content += '</body></html>';
                
                const blob = new Blob([content], { type: 'application/msword' });
                saveAs(blob, 'datanotes-report.doc');
            }

            exportToJSON() {
                const data = {
                    notes: this.notes,
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                saveAs(blob, 'datanotes-backup.json');
            }

            // Local storage functions
            saveToLocalStorage() {
                localStorage.setItem('datanotes', JSON.stringify({
                    notes: this.notes,
                    noteIdCounter: this.noteIdCounter
                }));
            }

            loadFromLocalStorage() {
                const saved = localStorage.getItem('datanotes');
                if (saved) {
                    const data = JSON.parse(saved);
                    this.notes = data.notes.map(note => ({
                        ...note,
                        createdAt: new Date(note.createdAt),
                        lastModified: new Date(note.lastModified)
                    }));
                    this.noteIdCounter = data.noteIdCounter;
                }
            }
        }

        // Initialize the app
        const app = new DataNotesAI();
        
        // Load saved data on page load
        window.addEventListener('load', () => {
            app.loadFromLocalStorage();
            app.updateDisplay();
        });

        // Save data periodically
        setInterval(() => {
            app.saveToLocalStorage();
        }, 5000);

        // Save data before page unload
        window.addEventListener('beforeunload', () => {
            app.saveToLocalStorage();
        });
    </script>
</body>
</html>